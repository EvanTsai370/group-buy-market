# 测试环境配置

spring:
  datasource:
    # 由 Testcontainers 动态配置
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5

  data:
    redis:
      # 由 Testcontainers 动态配置
      database: 0
      timeout: 3000ms

  # 启用 Flyway 自动迁移（测试环境需要创建表）
  flyway:
    enabled: true
    baseline-on-migrate: true
    # Flyway会先执行主迁移(V1-V6)，然后是测试迁移(V99)
    # 注意：test resources中的db/migration会覆盖main resources，所以我们需要用不同的版本号
    locations: 
      - classpath:db/migration

  rabbitmq:
    # 由 Testcontainers 动态配置
    virtual-host: /
    listener:
      simple:
        auto-startup: false
      direct:
        auto-startup: false

logging:
  level:
    root: INFO
    org.example: DEBUG
    org.testcontainers: WARN
    org.springframework.test: DEBUG
    org.springframework.amqp: ERROR
